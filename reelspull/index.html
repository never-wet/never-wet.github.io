<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIF ë½‘ê¸° ê²Œì„</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        h1 {
            color: white;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .slot-container {
            width: 600px;
            height: 120px;
            border: 4px solid #fff;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            background: rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .slot-strip {
            display: flex;
            height: 100%;
            position: relative;
            transition: transform 0.1s linear;
        }

        .slot-strip.stopping {
            transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .gif-item {
            min-width: 120px;
            height: 112px;
            background: #f0f0f0;
            border-right: 2px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #666;
            position: relative;
            overflow: hidden;
        }

        .gif-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gif-item.spinning img {
            animation-play-state: paused;
            opacity: 0.8;
        }

        .center-highlight {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 120px;
            transform: translateX(-50%);
            border: 3px solid #ffd700;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
            pointer-events: none;
            z-index: 10;
        }

        .spin-button {
            background: linear-gradient(145deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .spin-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.6);
        }

        .spin-button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .result-container {
            margin-top: 30px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .winner-gif {
            max-width: 150px;
            max-height: 100px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: scale(0);
            animation: popIn 0.5s ease-out forwards;
        }

        @keyframes popIn {
            0% {
                transform: scale(0) rotate(180deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.1) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        .winner-text {
            color: #ffd700;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), 0 0 10px #ffd700;
            }
            to {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), 0 0 20px #ffd700, 0 0 30px #ffd700;
            }
        }

        .placeholder-gif {
            width: 100px;
            height: 100px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #f9ca24, #f0932b);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            text-align: center;
        }

        .big-winner-overlay {
            position: fixed;
            left: 0; top: 0; right: 0; bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            background: rgba(0,0,0,0.5);
            animation: fadeIn 0.5s;
        }

        @keyframes play-once {
          from {
            background-position: 0 0;
          }
          to {
            background-position: 100% 0;
          }
        }

        .big-winner-img {
            width: 320px;
            height: 320px;
            border-radius: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            background: white;
            animation: popInBig 0.5s;
            animation-name: play-once;
            animation-duration: 2s;
            animation-iteration-count: 1;

        }
        @keyframes popInBig {
            0% { transform: scale(0.2) rotate(-30deg); opacity: 0; }
            60% { transform: scale(1.1) rotate(0deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        @keyframes fadeOutBig {
            0% { opacity: 1; transform: scale(1);}
            100% { opacity: 0; transform: scale(0.7);}
        }
        @keyframes fadeIn {
            0% { opacity: 0;}
            100% { opacity: 1;}
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸ° GIF ë½‘ê¸° ê²Œì„</h1>

        <div class="slot-container">
            <div class="slot-strip" id="slotStrip">
                <!-- GIF items will be dynamically added here -->
            </div>
            <div class="center-highlight"></div>
            
        </div>
        

        <button class="spin-button" id="spinButton">ğŸ° SPIN!</button>

        <div class="result-container" id="resultContainer">
            <div style="color: white; opacity: 0.7;">SPIN ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ GIFë¥¼ ë½‘ì•„ë³´ì„¸ìš”!</div>
        </div>
    </div>

    <script>
        // ê¸°ë³¸ ìƒ˜í”Œ ì´ë¯¸ì§€ë“¤ (ì‹¤ì œë¡œëŠ” ì—¬ê¸°ì— GIF URLë“¤ì„ ë„£ìœ¼ì‹œë©´ ë©ë‹ˆë‹¤)
        // sampleGifsì— firstFrame ì†ì„± ì¶”ê°€ ì˜ˆì‹œ
        const sampleGifs = [
            { emoji: "gif/absmal.gif", firstFrame: "gif/absmal_firstframe.png" },
            { emoji: "gif/common.gif", firstFrame: "gif/common_firstframe.png" },
            { emoji: "gif/uncommon.gif", firstFrame: "gif/uncommon_firstframe.png" },
            { emoji: "gif/rare.gif", firstFrame: "gif/rare_firstframe.png" },
            { emoji: "gif/exotic.gif", firstFrame: "gif/exotic_firstframe.png" },
            { emoji: "gif/mythic.gif", firstFrame: "gif/mythic_firstframe.png" },
            { emoji: "gif/legendary.gif", firstFrame: "gif/legendary_firstframe.png" },
            { emoji: "gif/unreal.gif", firstFrame: "gif/unreal_firstframe.png" },
            { emoji: "gif/insane.gif", firstFrame: "gif/insane_firstframe.png" },
            { emoji: "gif/godlike.gif", firstFrame: "gif/godlike_firstframe.png" }
        ];

        const reelPicUrl = "gif/phone reel gif 1frame.png.svg"

        let isSpinning = false;
        let spinInterval;
        let currentOffset = 0;
        let spinSpeed = 12; // ì´ˆê¸° ì†ë„
        let spinTime = 0; // ìŠ¤í•€ ì‹œê°„ ì¶”ì 
        const itemWidth = 120;

        const slotStrip = document.getElementById('slotStrip');
        const spinButton = document.getElementById('spinButton');
        const resultContainer = document.getElementById('resultContainer');

        spinButton.addEventListener('click', startSpin);

        function setupSlots() {
            slotStrip.innerHTML = '';
            
            // ì¶©ë¶„í•œ ê°œìˆ˜ì˜ ì•„ì´í…œë“¤ì„ ìƒì„± (5ë²ˆ ë°˜ë³µìœ¼ë¡œ ëŠ˜ë¦¼)
            const totalItems = sampleGifs.length * 5;
            
            for (let i = 0; i < totalItems; i++) {
                const gifItem = document.createElement('div');
                gifItem.className = 'gif-item';
                
                const gif = sampleGifs[i % sampleGifs.length];
                // í”Œë ˆì´ìŠ¤í™€ë” div ìƒì„±
                const placeholder = document.createElement('div');
                placeholder.className = 'placeholder-gif';
                placeholder.innerHTML = `<img src="${reelPicUrl}" class="position ='0' top='0' left='0' width='100%' height='100%' pointer-events='none' opacity='1'">`;
                
                gifItem.appendChild(placeholder);
                gifItem.dataset.gifIndex = i % sampleGifs.length;
                slotStrip.appendChild(gifItem);
            }
        }

        function startSpin() {
            if (isSpinning) return;
            
            isSpinning = true;
            spinButton.disabled = true;
            resultContainer.innerHTML = '';
            
            // ì´ˆê¸° ì„¤ì • - ë§¤ë²ˆ ëœë¤í•œ ì‹œì‘ ìœ„ì¹˜ë¡œ ë‹¤ì–‘ì„± í™•ë³´
            currentOffset = Math.random() * -600 - 120; // -720 ~ -120 ì‚¬ì´ì˜ ëœë¤ ì‹œì‘
            spinSpeed = 35;
            spinTime = 0;
            
            // ëª¨ë“  ì•„ì´í…œì— spinning í´ë˜ìŠ¤ ê´€ë¦¬
            const allItems = slotStrip.querySelectorAll('.gif-item');
            allItems.forEach(item => item.classList.remove('spinning'));
            setTimeout(() => {
                allItems.forEach(item => item.classList.add('spinning'));
            }, 10);
            
            // ë¶€ë“œëŸ¬ìš´ ìŠ¤í”¼ë‹ ì‹œì‘
            spinInterval = setInterval(() => {
                spinTime += 16;
                
                if (spinTime < 1200) {
                    spinSpeed = 35;
                } else if (spinTime < 2500) {
                    const decayFactor = (spinTime - 1200) / 1300;
                    spinSpeed = 35 * (1 - decayFactor * 0.8);
                } else if (spinTime < 3800) {
                    const decayFactor = (spinTime - 2500) / 1300;
                    spinSpeed = 7 * (1 - decayFactor * 0.7);
                } else {
                    spinSpeed = Math.max(0.3, spinSpeed * 0.90);
                    
                    if (spinSpeed < 2) {
                        // ì •í™•í•œ ê°€ìš´ë° ìœ„ì¹˜ ê³„ì‚° (ìŠ¬ë¡¯ ì»¨í…Œì´ë„ˆ ì¤‘ì‹¬: 300px, GIF ì¤‘ì‹¬: 60px)
                        const centerPosition = -currentOffset + 300;
                        const nearestItemIndex = Math.round(centerPosition / itemWidth);
                        const targetOffset = 325 - 55 - (nearestItemIndex * itemWidth); // GIF ì¤‘ì‹¬ì´ í•˜ì´ë¼ì´íŠ¸ ì¤‘ì‹¬ì— ì˜¤ë„ë¡
                        
                        const distance = targetOffset - currentOffset;
                        
                        if (Math.abs(distance) < 2) {
                            currentOffset = targetOffset;
                            slotStrip.style.transform = `translateX(${currentOffset}px)`;
                            clearInterval(spinInterval);
                            
                            showWinner();
                            
                            const allItems = slotStrip.querySelectorAll('.gif-item');
                            allItems.forEach(item => item.classList.remove('spinning'));
                            
                            isSpinning = false;
                            spinButton.disabled = false;

                            return;
                        } else {
                            spinSpeed = Math.min(1.5, Math.abs(distance) * 0.3);
                            if (distance < 1) spinSpeed = -spinSpeed;
                            currentOffset += spinSpeed;
                            slotStrip.style.transform = `translateX(${currentOffset}px)`;
                            return;
                        }
                    }
                }
                
                currentOffset -= spinSpeed;
                slotStrip.style.transform = `translateX(${currentOffset}px)`;
            }, 16);
        }

        function stopSpin() {
            // ì´ í•¨ìˆ˜ëŠ” ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ (startSpinì—ì„œ ëª¨ë“  ë¡œì§ ì²˜ë¦¬)
        }

        function showWinner() {
            // ê°€ìš´ë°ì— ìœ„ì¹˜í•œ GIF index ê³„ì‚°
            const centerPosition = -currentOffset + 300;
            const nearestItemIndex = Math.round(centerPosition / itemWidth);
            const actualIndex = nearestItemIndex % sampleGifs.length;
            const actualWinnerGif = sampleGifs[actualIndex];

            resultContainer.innerHTML = `
                <div class="winner-text">ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ğŸ‰</div>
            `;

            setTimeout(() => {
                const overlay = document.createElement('div');
                overlay.className = 'big-winner-overlay';
                // ì²˜ìŒì—” ì²« í”„ë ˆì„ ì´ë¯¸ì§€ë¥¼ ë³´ì—¬ì¤Œ
                overlay.innerHTML = `
                    <img class="big-winner-img" id="bigWinnerGif" src="${actualWinnerGif.emoji}">
                `;
                document.body.appendChild(overlay);

                const myGif = document.getElementById('bigWinnerGif');
                const gifDuration = 3000;


                // 1ì´ˆ í›„ í´ë¦­ ì´ë²¤íŠ¸ í™œì„±í™”
                setTimeout(() => {
                    function removeOverlay() {
                        overlay.style.animation = 'fadeOutBig 0.5s forwards';
                        setTimeout(() => {
                            if (overlay.parentNode) overlay.parentNode.removeChild(overlay);
                            document.removeEventListener('mousedown', removeOverlay);
                        }, 1000);
                    }
                    document.addEventListener('mousedown', removeOverlay);
                }, 1000);

                setTimeout( () => {
                    myGif.src = "gif/phone reel gif 1frame.png.svg";
                }, gifDuration);
            }, 500);
        }

        // ì´ˆê¸° ì„¤ì •
        setupSlots();
    </script>
</body>
</html>
