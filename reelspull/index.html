<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIF 뽑기 게임</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        h1 {
            color: white;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .slot-container {
            width: 600px;
            height: 120px;
            border: 4px solid #fff;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            background: rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .slot-strip {
            display: flex;
            height: 100%;
            position: relative;
            transition: transform 0.1s linear;
        }

        .slot-strip.stopping {
            transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .gif-item {
            min-width: 120px;
            height: 112px;
            background: #f0f0f0;
            border-right: 2px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #666;
            position: relative;
            overflow: hidden;
        }

        .gif-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gif-item.spinning img {
            animation-play-state: paused;
            opacity: 0.8;
        }

        .center-highlight {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 120px;
            transform: translateX(-50%);
            border: 3px solid #ffd700;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
            pointer-events: none;
            z-index: 10;
        }

        .spin-button {
            background: linear-gradient(145deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .spin-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.6);
        }

        .spin-button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .result-container {
            margin-top: 30px;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .winner-gif {
            max-width: 300px;
            max-height: 200px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: scale(0);
            animation: popIn 0.5s ease-out forwards;
        }

        @keyframes popIn {
            0% {
                transform: scale(0) rotate(180deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.1) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        .winner-text {
            color: #ffd700;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), 0 0 10px #ffd700;
            }
            to {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), 0 0 20px #ffd700, 0 0 30px #ffd700;
            }
        }

        .placeholder-gif {
            width: 100px;
            height: 100px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #f9ca24, #f0932b);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>🎰 GIF 뽑기 게임</h1>

        <div class="slot-container">
            <div class="slot-strip" id="slotStrip">
                <!-- GIF items will be dynamically added here -->
            </div>
            <div class="center-highlight"></div>
            
        </div>
        

        <button class="spin-button" id="spinButton">🎰 SPIN!</button>

        <div class="result-container" id="resultContainer">
            <div style="color: white; opacity: 0.7;">SPIN 버튼을 눌러서 GIF를 뽑아보세요!</div>
        </div>
    </div>

    <script>
        // 기본 샘플 이미지들 (실제로는 여기에 GIF URL들을 넣으시면 됩니다)
        const sampleGifs = [
            { name: "고양이", color: "#ff6b6b", emoji: "🐱" },
            { name: "강아지", color: "#4ecdc4", emoji: "🐶" },
            { name: "햄스터", color: "#45b7d1", emoji: "🐹" },
            { name: "토끼", color: "#f9ca24", emoji: "🐰" },
            { name: "여우", color: "#f0932b", emoji: "🦊" },
            { name: "판다", color: "#eb4d4b", emoji: "🐼" },
            { name: "사자", color: "#6c5ce7", emoji: "🦁" },
            { name: "호랑이", color: "#fd79a8", emoji: "🐯" },
            { name: "코알라", color: "#00b894", emoji: "🐨" },
            { name: "원숭이", color: "#e17055", emoji: "🐵" }
        ];

        let isSpinning = false;
        let spinInterval;
        let currentOffset = 0;
        let spinSpeed = 12; // 초기 속도
        let spinTime = 0; // 스핀 시간 추적
        const itemWidth = 120;

        const slotStrip = document.getElementById('slotStrip');
        const spinButton = document.getElementById('spinButton');
        const resultContainer = document.getElementById('resultContainer');

        spinButton.addEventListener('click', startSpin);

        function setupSlots() {
            slotStrip.innerHTML = '';
            
            // 충분한 개수의 아이템들을 생성 (5번 반복으로 늘림)
            const totalItems = sampleGifs.length * 5;
            
            for (let i = 0; i < totalItems; i++) {
                const gifItem = document.createElement('div');
                gifItem.className = 'gif-item';
                
                const gif = sampleGifs[i % sampleGifs.length];
                
                // 플레이스홀더 div 생성
                const placeholder = document.createElement('div');
                placeholder.className = 'placeholder-gif';
                placeholder.style.background = gif.color;
                placeholder.innerHTML = `${gif.emoji}<br>${gif.name}`;
                
                gifItem.appendChild(placeholder);
                gifItem.dataset.gifIndex = i % sampleGifs.length;
                slotStrip.appendChild(gifItem);
            }
        }

        function startSpin() {
            if (isSpinning) return;
            
            isSpinning = true;
            spinButton.disabled = true;
            resultContainer.innerHTML = '';
            
            // 초기 설정 - 매번 랜덤한 시작 위치로 다양성 확보
            currentOffset = Math.random() * -600 - 120; // -720 ~ -120 사이의 랜덤 시작
            spinSpeed = 35;
            spinTime = 0;
            
            // 모든 아이템에 spinning 클래스 관리
            const allItems = slotStrip.querySelectorAll('.gif-item');
            allItems.forEach(item => item.classList.remove('spinning'));
            setTimeout(() => {
                allItems.forEach(item => item.classList.add('spinning'));
            }, 10);
            
            // 부드러운 스피닝 시작
            spinInterval = setInterval(() => {
                spinTime += 16;
                
                if (spinTime < 1200) {
                    spinSpeed = 35;
                } else if (spinTime < 2500) {
                    const decayFactor = (spinTime - 1200) / 1300;
                    spinSpeed = 35 * (1 - decayFactor * 0.8);
                } else if (spinTime < 3800) {
                    const decayFactor = (spinTime - 2500) / 1300;
                    spinSpeed = 7 * (1 - decayFactor * 0.7);
                } else {
                    spinSpeed = Math.max(0.3, spinSpeed * 0.90);
                    
                    if (spinSpeed < 2) {
                        // 정확한 가운데 위치 계산 (슬롯 컨테이너 중심: 300px, GIF 중심: 60px)
                        const centerPosition = -currentOffset + 300;
                        const nearestItemIndex = Math.round(centerPosition / itemWidth);
                        const targetOffset = 325 - 60 - (nearestItemIndex * itemWidth); // GIF 중심이 하이라이트 중심에 오도록
                        
                        const distance = targetOffset - currentOffset;
                        
                        if (Math.abs(distance) < 2) {
                            currentOffset = targetOffset;
                            slotStrip.style.transform = `translateX(${currentOffset}px)`;
                            clearInterval(spinInterval);
                            
                            setTimeout(() => {
                                // 실제 가운데 있는 GIF 찾기
                                showWinner();
                                
                                const allItems = slotStrip.querySelectorAll('.gif-item');
                                allItems.forEach(item => item.classList.remove('spinning'));
                                
                                isSpinning = false;
                                spinButton.disabled = false;
                            }, 200);
                            return;
                        } else {
                            spinSpeed = Math.min(1.5, Math.abs(distance) * 0.3);
                            if (distance < 1) spinSpeed = -spinSpeed;
                            currentOffset += spinSpeed;
                            slotStrip.style.transform = `translateX(${currentOffset}px)`;
                            return;
                        }
                    }
                }
                
                currentOffset -= spinSpeed;
                slotStrip.style.transform = `translateX(${currentOffset}px)`;
            }, 16);
        }

        function stopSpin() {
            // 이 함수는 더 이상 사용하지 않음 (startSpin에서 모든 로직 처리)
        }

        function showWinner() {
            // 정확한 가운데 위치 계산 (하이라이트 상자 중심: 300px)
            const centerPosition = -currentOffset + 100;
            const centerItemIndex = Math.round(centerPosition / itemWidth);
            
            // 음수 처리 및 배열 범위 내로 조정
            const normalizedIndex = ((centerItemIndex % sampleGifs.length) + sampleGifs.length) % sampleGifs.length;
            const actualWinnerGif = sampleGifs[normalizedIndex];
            
            console.log(`Center position: ${centerPosition}, Item index: ${centerItemIndex}, Normalized: ${normalizedIndex}, Winner: ${actualWinnerGif.name}`);
            
            resultContainer.innerHTML = `
                <div class="winner-text">🎉 축하합니다! 🎉</div>
                <div class="placeholder-gif winner-gif" style="background: ${actualWinnerGif.color}">
                    ${actualWinnerGif.emoji}<br>${actualWinnerGif.name}
                </div>
            `;
        }

        // 초기 설정
        setupSlots();
    </script>
</body>
</html>